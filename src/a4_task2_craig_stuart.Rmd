---
title: "assignment 4_task 2"
author: "Craig Stuart"
date: "11/13/2020"
output: html_document
---

```{r setup, include=TRUE, warning=FALSE, message=FALSE}
knitr::opts_chunk$set(echo = TRUE, warning = FALSE, message = FALSE)

#attach all necessary packages
library(tidyverse)
library(here)
library(janitor)
library(lubridate)
library(knitr)
library(effsize)
```

#### Read in Bonanza Creek data
```{r}
bonanza_creek <- read_csv(here("data", "bonanza_hares.csv"))
```

## 1. Introduction
- 4 - 5 sentence "mini-introduction" to what this study is exploring, including basic background information about the subject, site and study (with citations as needed), and a brief overview of what is included in the exploratory report.

## 2. Data and Analyses
- A 3 - 4 sentence section in which you briefly describe the data, including citation & credit as needed, and provide an overview of the main analysis, statistical methods and tools used

## 3. Exploratory Findings

### - Annual juvenile Snowshoe hare trap counts

- Find the total number of juvenile hare trappings for each year of the study
- `filer()` for juvenile observations, `mutate()` the date to get a year variable, and summarize the `count()` by year
- Use `ggplot()` to visualize the absolute count per year

```{r}
juvenile_trap <- bonanza_creek %>% 
  filter(age == "j") %>% 
  mutate(date_new = mdy(date)) %>% 
  mutate(year = year(date_new)) %>% 
  count(year)

ggplot(data = juvenile_trap, aes(x = year, y = n)) +
  geom_bar(stat = "identity", fill = "gray", color = "black") +
  labs(x = "Study Year", y = "Number of Counts", title = "Annual Juvenile Hare Trap Counts") +
  scale_y_continuous(breaks = seq(0,130,20)) +
  theme_bw()
```

- Use `summary()` to display mean, median, max, and min

```{r}
summary(juvenile_trap)
```
- The maximum number of juvenile hare trappings occurred in 1999 (n = 126) and the minimum juvenile hare trappings occurred in 2010 (n = 2). The mean hare trappings throughout the entire study was 31.5 and the median was 18.5. Some general trend notes would be that the number of juvenile hare trappings had high variance from year to year. What this graph fails to present is the amount of effort put into each year. For instance, it would make sense if in 2010 only two days resulted in 2 trap counts, but the data would be very different if only 2 trap counts were observed in 365 days of the study. Therefore, going forward, a better way to standardize the juvenile hare population is to calculate the trap count per unit effort.


### - Visualize juvenile Snowshoe hare weights 

- Compare juvenile hare weights by sex and site (grid)

- Juvenile hare weight vs. sex
```{r}
j_weights_sex <- bonanza_creek %>% 
  select("weight", "age", "sex") %>% 
  filter(age == "j") %>% 
  mutate(sex = case_when(
    sex %in% "f" ~ "Female",
    sex %in% "m" ~ "Male"))

ggplot(data = j_weights_sex, aes(weight)) +
  geom_histogram(bins = 20) +
  facet_wrap(~sex) +
  labs(x = "Weight (g)", y = "Count", title = "Juvenile Hare Weight Histogram Distribution by Sex")

ggplot(data = j_weights_sex, aes(sample = weight)) +
  geom_qq() +
  facet_wrap(~sex)
```

- Juvenile hare weight vs. site(grid)

```{r}
j_weight_grid <- bonanza_creek %>% 
  select("weight", "age", "grid") %>% 
  filter(age == "j")

ggplot(data = j_weight_grid, aes(weight)) +
  geom_histogram(bins = 20) +
  facet_wrap(~grid)

ggplot(data = j_weight_grid, aes(sample = weight)) +
  geom_qq() +
  facet_wrap(~grid)
```

- in 2 - 3 sentences below your visualization(s) describe in text the main takeaways that you would want the audience to understand from your figures.

### - Juvenile weight comparison

- Summary statistics

```{r}
sex_weight_stat <- j_weights_sex %>% 
  filter(weight != "NA") %>% 
  group_by(sex) %>% 
  summarize(
    mean_weight = mean(weight),
    sd_weight = sd(weight),
    sample_size = n()
  )

kable(sex_weight_stat)
```

- t-test analysis

```{r}
m_weight <- j_weights_sex %>% 
  filter(sex == "Male") %>% 
  pull(weight)

f_weight <- j_weights_sex %>% 
  filter(weight != "NA") %>% 
  filter(sex == "Female") %>% 
  pull(weight)

hare_weight_ttest <- t.test(m_weight, f_weight)
hare_weight_ttest


cohen.d(m_weight, f_weight)
```

- A 2 - 3 sentence comprehensive statement of the means comparison, including at least:
The actual difference in means
Effect size (Cohen's *d*)
Outcome of a two-sample t-test


### - Relationship between juvenile weight & hind foot length

- Explore the relationship between juvenile snowshoe hare hind foot length and weight

```{r}
footlength_weight <- bonanza_creek %>% 
  select("age", "weight", "hindft") %>% 
  filter(age == "j")


ggplot(data = footlength_weight, aes(x = weight, y = hindft)) +
  geom_point() +
  labs(x = "Weight (g)", y = "Hind Foot Length (mm)", title = "Juvenile Hare Weight and High Foot Length Comparison")

weight_hindft_lm <- lm(weight~hindft, data = footlength_weight)

summary(weight_hindft_lm)
```

- In 2 - 3 sentences below your figure, describe the outcome of your linear regression exploration (e.g. slope interpretation, R2 value, and Pearson's r correlation) and touch briefly on which assumption(s) of linear regression may be a concern, and additional thoughts you have about how well (or not wellâ€¦) the linear model describes the relationship. What worries you?

## 4. Summary
- Include a very short summary describing your main findings from your juvenile hares exploration (bulletpoints are fine)

## 5. Citations
- Kielland, K., F.S. Chapin, R.W. Ruess, and Bonanza Creek LTER. 2017. Snowshoe hare physical data in Bonanza Creek Experimental Forest: 1999-Present ver 22. Environmental Data Initiative. https://doi.org/10.6073/pasta/03dce4856d79b91557d8e6ce2cbcdc14







